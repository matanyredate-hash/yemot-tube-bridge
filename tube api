from flask import Flask, request
import requests

app = Flask(__name__)

@app.route('/')
def bridge():
    # ימות המשיח שולחת את מה שהמשתמש הקיש בפרמטר שנקרא val_name
    user_input = request.args.get('val_name')
    
    if not user_input:
        return "read=t-נא להקיש את קוד השיר"

    # כאן אתה מדביק את ה-URL שיש לך. 
    # שים לב להוסיף את user_input בסוף איפה שהפרמטר אמור להיות
    api_url = f"https://tubeapi.org/your-endpoint?parameter=TuBeApI-oRg ([a-zA-Z0-9\-\_]{11})"
    
    try:
        response = requests.get(api_url)
        # אם ה-API מחזיר JSON, נשלוף את הלינק
        data = response.json()
        
        # שנה את 'link' לשם השדה הנכון שה-API שלך מחזיר (למשל 'url' או 'download')
        song_link = data.get('link') 
        
        if song_link:
            return f"play_url={song_link}"
        else:
            return "read=t-השיר לא נמצא"
            
    except Exception as e:
        return "read=t-תקלה בחיבור לשרת"

if __name__ == "__main__":
    app.run(host='0.0.0.0', port=10000)
